# DLS Image Bot

Суть проекта: телеграм-бот для переноса стиля. Для реализации самого бота был применен асинхронный фреймворк aiogram.
Для самого переноса стиля используется нейронная сеть на PyTorch.
(по мотивам [алгоритма](https://arxiv.org/abs/1508.06576))



Примеры изображений

![This is an image](/images/examples/example_2.jpg)
![This is an image](/images/examples/example_3.jpg)


Особенности реализации.
1. Общение с ботом(Болталка). Добавил модель ответа на сообщения пользователю, которую реализовывал в рамках практики в университете. Данные с соревнования Яндек.Алгоритм2018(часть датасета, на котором обучили Алису). Не вдаваясь в подробности, векторизация текста tf-idf, преобразовав вопросы в числовые векторы и использовать метод k-ближайших соседей. Также размерность данных была сокращена простым методом главных компонент. 
2. Асинхронность. aiogram -> весь интерфейс асинхронный. Чтобы обработка изображения не блокировала основной поток был использован модуль threading.
Соответственно сама обработка изображения и пересылка результата пользователю запускаются в отдельном потоке с помощью threading.Thread. То есть бот не зависает, а позволяет продолжать диалог. 
3. Для удобности интерфейса были использованы Inline-клавиатуры.
4. Дополнительно создан класс для предобработки присланных изображений. Так как их надо приводить к одному размеру, но и не хочется терять соотношение сторон,- изображения ресайзятся с добавлением паддинга, с чем нам помогает ImageOps.pad из либы Pillow. При отправке пользователю изображение ресайзится обратно до исходного размера с помощью ImageOps.fit
5. Взято только 11 первых слоев VGG-19, чтоб не качать всю модель, но при этом их хватает для реализации алгоритма.

